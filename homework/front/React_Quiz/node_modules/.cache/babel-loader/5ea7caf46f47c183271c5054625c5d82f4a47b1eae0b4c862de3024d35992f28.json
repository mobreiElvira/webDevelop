{"ast":null,"code":"import * as React from 'react';\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport canUseDom from \"@rc-component/util/es/Dom/canUseDom\";\nimport OrderContext from \"./Context\";\nconst EMPTY_LIST = [];\n\n/**\n * Will add `div` to document. Nest call will keep order\n * @param render Render DOM in document\n */\nexport default function useDom(render, debug) {\n  const [ele] = React.useState(() => {\n    if (!canUseDom()) {\n      return null;\n    }\n    const defaultEle = document.createElement('div');\n    if (process.env.NODE_ENV !== 'production' && debug) {\n      defaultEle.setAttribute('data-debug', debug);\n    }\n    return defaultEle;\n  });\n\n  // ========================== Order ==========================\n  const appendedRef = React.useRef(false);\n  const queueCreate = React.useContext(OrderContext);\n  const [queue, setQueue] = React.useState(EMPTY_LIST);\n  const mergedQueueCreate = queueCreate || (appendedRef.current ? undefined : appendFn => {\n    setQueue(origin => {\n      const newQueue = [appendFn, ...origin];\n      return newQueue;\n    });\n  });\n\n  // =========================== DOM ===========================\n  function append() {\n    if (!ele.parentElement) {\n      document.body.appendChild(ele);\n    }\n    appendedRef.current = true;\n  }\n  function cleanup() {\n    var _ele$parentElement;\n    (_ele$parentElement = ele.parentElement) === null || _ele$parentElement === void 0 || _ele$parentElement.removeChild(ele);\n    appendedRef.current = false;\n  }\n  useLayoutEffect(() => {\n    if (render) {\n      if (queueCreate) {\n        queueCreate(append);\n      } else {\n        append();\n      }\n    } else {\n      cleanup();\n    }\n    return cleanup;\n  }, [render]);\n  useLayoutEffect(() => {\n    if (queue.length) {\n      queue.forEach(appendFn => appendFn());\n      setQueue(EMPTY_LIST);\n    }\n  }, [queue]);\n  return [ele, mergedQueueCreate];\n}","map":{"version":3,"names":["React","useLayoutEffect","canUseDom","OrderContext","EMPTY_LIST","useDom","render","debug","ele","useState","defaultEle","document","createElement","process","env","NODE_ENV","setAttribute","appendedRef","useRef","queueCreate","useContext","queue","setQueue","mergedQueueCreate","current","undefined","appendFn","origin","newQueue","append","parentElement","body","appendChild","cleanup","_ele$parentElement","removeChild","length","forEach"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/portal/es/useDom.js"],"sourcesContent":["import * as React from 'react';\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport canUseDom from \"@rc-component/util/es/Dom/canUseDom\";\nimport OrderContext from \"./Context\";\nconst EMPTY_LIST = [];\n\n/**\n * Will add `div` to document. Nest call will keep order\n * @param render Render DOM in document\n */\nexport default function useDom(render, debug) {\n  const [ele] = React.useState(() => {\n    if (!canUseDom()) {\n      return null;\n    }\n    const defaultEle = document.createElement('div');\n    if (process.env.NODE_ENV !== 'production' && debug) {\n      defaultEle.setAttribute('data-debug', debug);\n    }\n    return defaultEle;\n  });\n\n  // ========================== Order ==========================\n  const appendedRef = React.useRef(false);\n  const queueCreate = React.useContext(OrderContext);\n  const [queue, setQueue] = React.useState(EMPTY_LIST);\n  const mergedQueueCreate = queueCreate || (appendedRef.current ? undefined : appendFn => {\n    setQueue(origin => {\n      const newQueue = [appendFn, ...origin];\n      return newQueue;\n    });\n  });\n\n  // =========================== DOM ===========================\n  function append() {\n    if (!ele.parentElement) {\n      document.body.appendChild(ele);\n    }\n    appendedRef.current = true;\n  }\n  function cleanup() {\n    ele.parentElement?.removeChild(ele);\n    appendedRef.current = false;\n  }\n  useLayoutEffect(() => {\n    if (render) {\n      if (queueCreate) {\n        queueCreate(append);\n      } else {\n        append();\n      }\n    } else {\n      cleanup();\n    }\n    return cleanup;\n  }, [render]);\n  useLayoutEffect(() => {\n    if (queue.length) {\n      queue.forEach(appendFn => appendFn());\n      setQueue(EMPTY_LIST);\n    }\n  }, [queue]);\n  return [ele, mergedQueueCreate];\n}"],"mappings":"AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,OAAOC,eAAe,MAAM,6CAA6C;AACzE,OAAOC,SAAS,MAAM,qCAAqC;AAC3D,OAAOC,YAAY,MAAM,WAAW;AACpC,MAAMC,UAAU,GAAG,EAAE;;AAErB;AACA;AACA;AACA;AACA,eAAe,SAASC,MAAMA,CAACC,MAAM,EAAEC,KAAK,EAAE;EAC5C,MAAM,CAACC,GAAG,CAAC,GAAGR,KAAK,CAACS,QAAQ,CAAC,MAAM;IACjC,IAAI,CAACP,SAAS,CAAC,CAAC,EAAE;MAChB,OAAO,IAAI;IACb;IACA,MAAMQ,UAAU,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IAChD,IAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,IAAIR,KAAK,EAAE;MAClDG,UAAU,CAACM,YAAY,CAAC,YAAY,EAAET,KAAK,CAAC;IAC9C;IACA,OAAOG,UAAU;EACnB,CAAC,CAAC;;EAEF;EACA,MAAMO,WAAW,GAAGjB,KAAK,CAACkB,MAAM,CAAC,KAAK,CAAC;EACvC,MAAMC,WAAW,GAAGnB,KAAK,CAACoB,UAAU,CAACjB,YAAY,CAAC;EAClD,MAAM,CAACkB,KAAK,EAAEC,QAAQ,CAAC,GAAGtB,KAAK,CAACS,QAAQ,CAACL,UAAU,CAAC;EACpD,MAAMmB,iBAAiB,GAAGJ,WAAW,KAAKF,WAAW,CAACO,OAAO,GAAGC,SAAS,GAAGC,QAAQ,IAAI;IACtFJ,QAAQ,CAACK,MAAM,IAAI;MACjB,MAAMC,QAAQ,GAAG,CAACF,QAAQ,EAAE,GAAGC,MAAM,CAAC;MACtC,OAAOC,QAAQ;IACjB,CAAC,CAAC;EACJ,CAAC,CAAC;;EAEF;EACA,SAASC,MAAMA,CAAA,EAAG;IAChB,IAAI,CAACrB,GAAG,CAACsB,aAAa,EAAE;MACtBnB,QAAQ,CAACoB,IAAI,CAACC,WAAW,CAACxB,GAAG,CAAC;IAChC;IACAS,WAAW,CAACO,OAAO,GAAG,IAAI;EAC5B;EACA,SAASS,OAAOA,CAAA,EAAG;IAAA,IAAAC,kBAAA;IACjB,CAAAA,kBAAA,GAAA1B,GAAG,CAACsB,aAAa,cAAAI,kBAAA,eAAjBA,kBAAA,CAAmBC,WAAW,CAAC3B,GAAG,CAAC;IACnCS,WAAW,CAACO,OAAO,GAAG,KAAK;EAC7B;EACAvB,eAAe,CAAC,MAAM;IACpB,IAAIK,MAAM,EAAE;MACV,IAAIa,WAAW,EAAE;QACfA,WAAW,CAACU,MAAM,CAAC;MACrB,CAAC,MAAM;QACLA,MAAM,CAAC,CAAC;MACV;IACF,CAAC,MAAM;MACLI,OAAO,CAAC,CAAC;IACX;IACA,OAAOA,OAAO;EAChB,CAAC,EAAE,CAAC3B,MAAM,CAAC,CAAC;EACZL,eAAe,CAAC,MAAM;IACpB,IAAIoB,KAAK,CAACe,MAAM,EAAE;MAChBf,KAAK,CAACgB,OAAO,CAACX,QAAQ,IAAIA,QAAQ,CAAC,CAAC,CAAC;MACrCJ,QAAQ,CAAClB,UAAU,CAAC;IACtB;EACF,CAAC,EAAE,CAACiB,KAAK,CAAC,CAAC;EACX,OAAO,CAACb,GAAG,EAAEe,iBAAiB,CAAC;AACjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}