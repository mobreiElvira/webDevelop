{"ast":null,"code":"import KeyCode from \"@rc-component/util/es/KeyCode\";\nimport raf from \"@rc-component/util/es/raf\";\nimport * as React from 'react';\nconst {\n  ESC,\n  TAB\n} = KeyCode;\nexport default function useAccessibility(_ref) {\n  let {\n    visible,\n    triggerRef,\n    onVisibleChange,\n    autoFocus,\n    overlayRef\n  } = _ref;\n  const focusMenuRef = React.useRef(false);\n  const handleCloseMenuAndReturnFocus = () => {\n    if (visible) {\n      var _triggerRef$current, _triggerRef$current$f;\n      (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 || (_triggerRef$current$f = _triggerRef$current.focus) === null || _triggerRef$current$f === void 0 || _triggerRef$current$f.call(_triggerRef$current);\n      onVisibleChange === null || onVisibleChange === void 0 || onVisibleChange(false);\n    }\n  };\n  const focusMenu = () => {\n    var _overlayRef$current;\n    if ((_overlayRef$current = overlayRef.current) !== null && _overlayRef$current !== void 0 && _overlayRef$current.focus) {\n      overlayRef.current.focus();\n      focusMenuRef.current = true;\n      return true;\n    }\n    return false;\n  };\n  const handleKeyDown = event => {\n    switch (event.keyCode) {\n      case ESC:\n        handleCloseMenuAndReturnFocus();\n        break;\n      case TAB:\n        {\n          let focusResult = false;\n          if (!focusMenuRef.current) {\n            focusResult = focusMenu();\n          }\n          if (focusResult) {\n            event.preventDefault();\n          } else {\n            handleCloseMenuAndReturnFocus();\n          }\n          break;\n        }\n    }\n  };\n  React.useEffect(() => {\n    if (visible) {\n      window.addEventListener('keydown', handleKeyDown);\n      if (autoFocus) {\n        // FIXME: hack with raf\n        raf(focusMenu, 3);\n      }\n      return () => {\n        window.removeEventListener('keydown', handleKeyDown);\n        focusMenuRef.current = false;\n      };\n    }\n    return () => {\n      focusMenuRef.current = false;\n    };\n  }, [visible]); // eslint-disable-line react-hooks/exhaustive-deps\n}","map":{"version":3,"names":["KeyCode","raf","React","ESC","TAB","useAccessibility","_ref","visible","triggerRef","onVisibleChange","autoFocus","overlayRef","focusMenuRef","useRef","handleCloseMenuAndReturnFocus","_triggerRef$current","_triggerRef$current$f","current","focus","call","focusMenu","_overlayRef$current","handleKeyDown","event","keyCode","focusResult","preventDefault","useEffect","window","addEventListener","removeEventListener"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/dropdown/es/hooks/useAccessibility.js"],"sourcesContent":["import KeyCode from \"@rc-component/util/es/KeyCode\";\nimport raf from \"@rc-component/util/es/raf\";\nimport * as React from 'react';\nconst {\n  ESC,\n  TAB\n} = KeyCode;\nexport default function useAccessibility({\n  visible,\n  triggerRef,\n  onVisibleChange,\n  autoFocus,\n  overlayRef\n}) {\n  const focusMenuRef = React.useRef(false);\n  const handleCloseMenuAndReturnFocus = () => {\n    if (visible) {\n      triggerRef.current?.focus?.();\n      onVisibleChange?.(false);\n    }\n  };\n  const focusMenu = () => {\n    if (overlayRef.current?.focus) {\n      overlayRef.current.focus();\n      focusMenuRef.current = true;\n      return true;\n    }\n    return false;\n  };\n  const handleKeyDown = event => {\n    switch (event.keyCode) {\n      case ESC:\n        handleCloseMenuAndReturnFocus();\n        break;\n      case TAB:\n        {\n          let focusResult = false;\n          if (!focusMenuRef.current) {\n            focusResult = focusMenu();\n          }\n          if (focusResult) {\n            event.preventDefault();\n          } else {\n            handleCloseMenuAndReturnFocus();\n          }\n          break;\n        }\n    }\n  };\n  React.useEffect(() => {\n    if (visible) {\n      window.addEventListener('keydown', handleKeyDown);\n      if (autoFocus) {\n        // FIXME: hack with raf\n        raf(focusMenu, 3);\n      }\n      return () => {\n        window.removeEventListener('keydown', handleKeyDown);\n        focusMenuRef.current = false;\n      };\n    }\n    return () => {\n      focusMenuRef.current = false;\n    };\n  }, [visible]); // eslint-disable-line react-hooks/exhaustive-deps\n}"],"mappings":"AAAA,OAAOA,OAAO,MAAM,+BAA+B;AACnD,OAAOC,GAAG,MAAM,2BAA2B;AAC3C,OAAO,KAAKC,KAAK,MAAM,OAAO;AAC9B,MAAM;EACJC,GAAG;EACHC;AACF,CAAC,GAAGJ,OAAO;AACX,eAAe,SAASK,gBAAgBA,CAAAC,IAAA,EAMrC;EAAA,IANsC;IACvCC,OAAO;IACPC,UAAU;IACVC,eAAe;IACfC,SAAS;IACTC;EACF,CAAC,GAAAL,IAAA;EACC,MAAMM,YAAY,GAAGV,KAAK,CAACW,MAAM,CAAC,KAAK,CAAC;EACxC,MAAMC,6BAA6B,GAAGA,CAAA,KAAM;IAC1C,IAAIP,OAAO,EAAE;MAAA,IAAAQ,mBAAA,EAAAC,qBAAA;MACX,CAAAD,mBAAA,GAAAP,UAAU,CAACS,OAAO,cAAAF,mBAAA,gBAAAC,qBAAA,GAAlBD,mBAAA,CAAoBG,KAAK,cAAAF,qBAAA,eAAzBA,qBAAA,CAAAG,IAAA,CAAAJ,mBAA4B,CAAC;MAC7BN,eAAe,aAAfA,eAAe,eAAfA,eAAe,CAAG,KAAK,CAAC;IAC1B;EACF,CAAC;EACD,MAAMW,SAAS,GAAGA,CAAA,KAAM;IAAA,IAAAC,mBAAA;IACtB,KAAAA,mBAAA,GAAIV,UAAU,CAACM,OAAO,cAAAI,mBAAA,eAAlBA,mBAAA,CAAoBH,KAAK,EAAE;MAC7BP,UAAU,CAACM,OAAO,CAACC,KAAK,CAAC,CAAC;MAC1BN,YAAY,CAACK,OAAO,GAAG,IAAI;MAC3B,OAAO,IAAI;IACb;IACA,OAAO,KAAK;EACd,CAAC;EACD,MAAMK,aAAa,GAAGC,KAAK,IAAI;IAC7B,QAAQA,KAAK,CAACC,OAAO;MACnB,KAAKrB,GAAG;QACNW,6BAA6B,CAAC,CAAC;QAC/B;MACF,KAAKV,GAAG;QACN;UACE,IAAIqB,WAAW,GAAG,KAAK;UACvB,IAAI,CAACb,YAAY,CAACK,OAAO,EAAE;YACzBQ,WAAW,GAAGL,SAAS,CAAC,CAAC;UAC3B;UACA,IAAIK,WAAW,EAAE;YACfF,KAAK,CAACG,cAAc,CAAC,CAAC;UACxB,CAAC,MAAM;YACLZ,6BAA6B,CAAC,CAAC;UACjC;UACA;QACF;IACJ;EACF,CAAC;EACDZ,KAAK,CAACyB,SAAS,CAAC,MAAM;IACpB,IAAIpB,OAAO,EAAE;MACXqB,MAAM,CAACC,gBAAgB,CAAC,SAAS,EAAEP,aAAa,CAAC;MACjD,IAAIZ,SAAS,EAAE;QACb;QACAT,GAAG,CAACmB,SAAS,EAAE,CAAC,CAAC;MACnB;MACA,OAAO,MAAM;QACXQ,MAAM,CAACE,mBAAmB,CAAC,SAAS,EAAER,aAAa,CAAC;QACpDV,YAAY,CAACK,OAAO,GAAG,KAAK;MAC9B,CAAC;IACH;IACA,OAAO,MAAM;MACXL,YAAY,CAACK,OAAO,GAAG,KAAK;IAC9B,CAAC;EACH,CAAC,EAAE,CAACV,OAAO,CAAC,CAAC,CAAC,CAAC;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}