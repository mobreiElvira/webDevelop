{"ast":null,"code":"import useEvent from \"@rc-component/util/es/hooks/useEvent\";\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport isEqual from \"@rc-component/util/es/isEqual\";\nimport * as React from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createContext(defaultValue) {\n  const Context = /*#__PURE__*/React.createContext(undefined);\n  const Provider = _ref => {\n    let {\n      value,\n      children\n    } = _ref;\n    const valueRef = React.useRef(value);\n    valueRef.current = value;\n    const [context] = React.useState(() => ({\n      getValue: () => valueRef.current,\n      listeners: new Set()\n    }));\n    useLayoutEffect(() => {\n      unstable_batchedUpdates(() => {\n        context.listeners.forEach(listener => {\n          listener(value);\n        });\n      });\n    }, [value]);\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: context\n    }, children);\n  };\n  return {\n    Context,\n    Provider,\n    defaultValue\n  };\n}\n\n/** e.g. useSelect(userContext) => user */\n\n/** e.g. useSelect(userContext, user => user.name) => user.name */\n\n/** e.g. useSelect(userContext, ['name', 'age']) => user { name, age } */\n\n/** e.g. useSelect(userContext, 'name') => user.name */\n\nexport function useContext(holder, selector) {\n  const eventSelector = useEvent(typeof selector === 'function' ? selector : ctx => {\n    if (selector === undefined) {\n      return ctx;\n    }\n    if (!Array.isArray(selector)) {\n      return ctx[selector];\n    }\n    const obj = {};\n    selector.forEach(key => {\n      obj[key] = ctx[key];\n    });\n    return obj;\n  });\n  const context = React.useContext(holder === null || holder === void 0 ? void 0 : holder.Context);\n  const {\n    listeners,\n    getValue\n  } = context || {};\n  const valueRef = React.useRef();\n  valueRef.current = eventSelector(context ? getValue() : holder === null || holder === void 0 ? void 0 : holder.defaultValue);\n  const [, forceUpdate] = React.useState({});\n  useLayoutEffect(() => {\n    if (!context) {\n      return;\n    }\n    function trigger(nextValue) {\n      const nextSelectorValue = eventSelector(nextValue);\n      if (!isEqual(valueRef.current, nextSelectorValue, true)) {\n        forceUpdate({});\n      }\n    }\n    listeners.add(trigger);\n    return () => {\n      listeners.delete(trigger);\n    };\n  }, [context]);\n  return valueRef.current;\n}","map":{"version":3,"names":["useEvent","useLayoutEffect","isEqual","React","unstable_batchedUpdates","createContext","defaultValue","Context","undefined","Provider","_ref","value","children","valueRef","useRef","current","context","useState","getValue","listeners","Set","forEach","listener","createElement","useContext","holder","selector","eventSelector","ctx","Array","isArray","obj","key","forceUpdate","trigger","nextValue","nextSelectorValue","add","delete"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/context/es/context.js"],"sourcesContent":["import useEvent from \"@rc-component/util/es/hooks/useEvent\";\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport isEqual from \"@rc-component/util/es/isEqual\";\nimport * as React from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createContext(defaultValue) {\n  const Context = /*#__PURE__*/React.createContext(undefined);\n  const Provider = ({\n    value,\n    children\n  }) => {\n    const valueRef = React.useRef(value);\n    valueRef.current = value;\n    const [context] = React.useState(() => ({\n      getValue: () => valueRef.current,\n      listeners: new Set()\n    }));\n    useLayoutEffect(() => {\n      unstable_batchedUpdates(() => {\n        context.listeners.forEach(listener => {\n          listener(value);\n        });\n      });\n    }, [value]);\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: context\n    }, children);\n  };\n  return {\n    Context,\n    Provider,\n    defaultValue\n  };\n}\n\n/** e.g. useSelect(userContext) => user */\n\n/** e.g. useSelect(userContext, user => user.name) => user.name */\n\n/** e.g. useSelect(userContext, ['name', 'age']) => user { name, age } */\n\n/** e.g. useSelect(userContext, 'name') => user.name */\n\nexport function useContext(holder, selector) {\n  const eventSelector = useEvent(typeof selector === 'function' ? selector : ctx => {\n    if (selector === undefined) {\n      return ctx;\n    }\n    if (!Array.isArray(selector)) {\n      return ctx[selector];\n    }\n    const obj = {};\n    selector.forEach(key => {\n      obj[key] = ctx[key];\n    });\n    return obj;\n  });\n  const context = React.useContext(holder?.Context);\n  const {\n    listeners,\n    getValue\n  } = context || {};\n  const valueRef = React.useRef();\n  valueRef.current = eventSelector(context ? getValue() : holder?.defaultValue);\n  const [, forceUpdate] = React.useState({});\n  useLayoutEffect(() => {\n    if (!context) {\n      return;\n    }\n    function trigger(nextValue) {\n      const nextSelectorValue = eventSelector(nextValue);\n      if (!isEqual(valueRef.current, nextSelectorValue, true)) {\n        forceUpdate({});\n      }\n    }\n    listeners.add(trigger);\n    return () => {\n      listeners.delete(trigger);\n    };\n  }, [context]);\n  return valueRef.current;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}