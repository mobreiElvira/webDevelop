{"ast":null,"code":"import * as React from 'react';\nimport { useRef, useCallback } from 'react';\nimport warning from \"@rc-component/util/es/warning\";\nimport { nextSlice } from \"../utils/timeUtil\";\nconst PATH_SPLIT = '__RC_UTIL_PATH_SPLIT__';\nconst getPathStr = keyPath => keyPath.join(PATH_SPLIT);\nconst getPathKeys = keyPathStr => keyPathStr.split(PATH_SPLIT);\nexport const OVERFLOW_KEY = 'rc-menu-more';\nexport default function useKeyRecords() {\n  const [, internalForceUpdate] = React.useState({});\n  const key2pathRef = useRef(new Map());\n  const path2keyRef = useRef(new Map());\n  const [overflowKeys, setOverflowKeys] = React.useState([]);\n  const updateRef = useRef(0);\n  const destroyRef = useRef(false);\n  const forceUpdate = () => {\n    if (!destroyRef.current) {\n      internalForceUpdate({});\n    }\n  };\n  const registerPath = useCallback((key, keyPath) => {\n    // Warning for invalidate or duplicated `key`\n    if (process.env.NODE_ENV !== 'production') {\n      warning(!key2pathRef.current.has(key), \"Duplicated key '\".concat(key, \"' used in Menu by path [\").concat(keyPath.join(' > '), \"]\"));\n    }\n\n    // Fill map\n    const connectedPath = getPathStr(keyPath);\n    path2keyRef.current.set(connectedPath, key);\n    key2pathRef.current.set(key, connectedPath);\n    updateRef.current += 1;\n    const id = updateRef.current;\n    nextSlice(() => {\n      if (id === updateRef.current) {\n        forceUpdate();\n      }\n    });\n  }, []);\n  const unregisterPath = useCallback((key, keyPath) => {\n    const connectedPath = getPathStr(keyPath);\n    path2keyRef.current.delete(connectedPath);\n    key2pathRef.current.delete(key);\n  }, []);\n  const refreshOverflowKeys = useCallback(keys => {\n    setOverflowKeys(keys);\n  }, []);\n  const getKeyPath = useCallback((eventKey, includeOverflow) => {\n    const fullPath = key2pathRef.current.get(eventKey) || '';\n    const keys = getPathKeys(fullPath);\n    if (includeOverflow && overflowKeys.includes(keys[0])) {\n      keys.unshift(OVERFLOW_KEY);\n    }\n    return keys;\n  }, [overflowKeys]);\n  const isSubPathKey = useCallback((pathKeys, eventKey) => pathKeys.filter(item => item !== undefined).some(pathKey => {\n    const pathKeyList = getKeyPath(pathKey, true);\n    return pathKeyList.includes(eventKey);\n  }), [getKeyPath]);\n  const getKeys = () => {\n    const keys = [...key2pathRef.current.keys()];\n    if (overflowKeys.length) {\n      keys.push(OVERFLOW_KEY);\n    }\n    return keys;\n  };\n\n  /**\n   * Find current key related child path keys\n   */\n  const getSubPathKeys = useCallback(key => {\n    const connectedPath = \"\".concat(key2pathRef.current.get(key)).concat(PATH_SPLIT);\n    const pathKeys = new Set();\n    [...path2keyRef.current.keys()].forEach(pathKey => {\n      if (pathKey.startsWith(connectedPath)) {\n        pathKeys.add(path2keyRef.current.get(pathKey));\n      }\n    });\n    return pathKeys;\n  }, []);\n  React.useEffect(() => () => {\n    destroyRef.current = true;\n  }, []);\n  return {\n    // Register\n    registerPath,\n    unregisterPath,\n    refreshOverflowKeys,\n    // Util\n    isSubPathKey,\n    getKeyPath,\n    getKeys,\n    getSubPathKeys\n  };\n}","map":{"version":3,"names":["React","useRef","useCallback","warning","nextSlice","PATH_SPLIT","getPathStr","keyPath","join","getPathKeys","keyPathStr","split","OVERFLOW_KEY","useKeyRecords","internalForceUpdate","useState","key2pathRef","Map","path2keyRef","overflowKeys","setOverflowKeys","updateRef","destroyRef","forceUpdate","current","registerPath","key","process","env","NODE_ENV","has","concat","connectedPath","set","id","unregisterPath","delete","refreshOverflowKeys","keys","getKeyPath","eventKey","includeOverflow","fullPath","get","includes","unshift","isSubPathKey","pathKeys","filter","item","undefined","some","pathKey","pathKeyList","getKeys","length","push","getSubPathKeys","Set","forEach","startsWith","add","useEffect"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/menu/es/hooks/useKeyRecords.js"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useCallback } from 'react';\nimport warning from \"@rc-component/util/es/warning\";\nimport { nextSlice } from \"../utils/timeUtil\";\nconst PATH_SPLIT = '__RC_UTIL_PATH_SPLIT__';\nconst getPathStr = keyPath => keyPath.join(PATH_SPLIT);\nconst getPathKeys = keyPathStr => keyPathStr.split(PATH_SPLIT);\nexport const OVERFLOW_KEY = 'rc-menu-more';\nexport default function useKeyRecords() {\n  const [, internalForceUpdate] = React.useState({});\n  const key2pathRef = useRef(new Map());\n  const path2keyRef = useRef(new Map());\n  const [overflowKeys, setOverflowKeys] = React.useState([]);\n  const updateRef = useRef(0);\n  const destroyRef = useRef(false);\n  const forceUpdate = () => {\n    if (!destroyRef.current) {\n      internalForceUpdate({});\n    }\n  };\n  const registerPath = useCallback((key, keyPath) => {\n    // Warning for invalidate or duplicated `key`\n    if (process.env.NODE_ENV !== 'production') {\n      warning(!key2pathRef.current.has(key), `Duplicated key '${key}' used in Menu by path [${keyPath.join(' > ')}]`);\n    }\n\n    // Fill map\n    const connectedPath = getPathStr(keyPath);\n    path2keyRef.current.set(connectedPath, key);\n    key2pathRef.current.set(key, connectedPath);\n    updateRef.current += 1;\n    const id = updateRef.current;\n    nextSlice(() => {\n      if (id === updateRef.current) {\n        forceUpdate();\n      }\n    });\n  }, []);\n  const unregisterPath = useCallback((key, keyPath) => {\n    const connectedPath = getPathStr(keyPath);\n    path2keyRef.current.delete(connectedPath);\n    key2pathRef.current.delete(key);\n  }, []);\n  const refreshOverflowKeys = useCallback(keys => {\n    setOverflowKeys(keys);\n  }, []);\n  const getKeyPath = useCallback((eventKey, includeOverflow) => {\n    const fullPath = key2pathRef.current.get(eventKey) || '';\n    const keys = getPathKeys(fullPath);\n    if (includeOverflow && overflowKeys.includes(keys[0])) {\n      keys.unshift(OVERFLOW_KEY);\n    }\n    return keys;\n  }, [overflowKeys]);\n  const isSubPathKey = useCallback((pathKeys, eventKey) => pathKeys.filter(item => item !== undefined).some(pathKey => {\n    const pathKeyList = getKeyPath(pathKey, true);\n    return pathKeyList.includes(eventKey);\n  }), [getKeyPath]);\n  const getKeys = () => {\n    const keys = [...key2pathRef.current.keys()];\n    if (overflowKeys.length) {\n      keys.push(OVERFLOW_KEY);\n    }\n    return keys;\n  };\n\n  /**\n   * Find current key related child path keys\n   */\n  const getSubPathKeys = useCallback(key => {\n    const connectedPath = `${key2pathRef.current.get(key)}${PATH_SPLIT}`;\n    const pathKeys = new Set();\n    [...path2keyRef.current.keys()].forEach(pathKey => {\n      if (pathKey.startsWith(connectedPath)) {\n        pathKeys.add(path2keyRef.current.get(pathKey));\n      }\n    });\n    return pathKeys;\n  }, []);\n  React.useEffect(() => () => {\n    destroyRef.current = true;\n  }, []);\n  return {\n    // Register\n    registerPath,\n    unregisterPath,\n    refreshOverflowKeys,\n    // Util\n    isSubPathKey,\n    getKeyPath,\n    getKeys,\n    getSubPathKeys\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}