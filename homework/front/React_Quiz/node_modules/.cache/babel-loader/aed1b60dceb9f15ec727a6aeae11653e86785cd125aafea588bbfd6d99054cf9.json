{"ast":null,"code":"import { extract as tokenExtractStyle, TOKEN_PREFIX } from \"./hooks/useCacheToken\";\nimport { CSS_VAR_PREFIX, extract as cssVarExtractStyle } from \"./hooks/useCSSVarRegister\";\nimport { extract as styleExtractStyle, STYLE_PREFIX } from \"./hooks/useStyleRegister\";\nimport { toStyleStr } from \"./util\";\nimport { ATTR_CACHE_MAP, serialize as serializeCacheMap } from \"./util/cacheMapUtil\";\nconst ExtractStyleFns = {\n  [STYLE_PREFIX]: styleExtractStyle,\n  [TOKEN_PREFIX]: tokenExtractStyle,\n  [CSS_VAR_PREFIX]: cssVarExtractStyle\n};\nfunction isNotNull(value) {\n  return value !== null;\n}\nexport default function extractStyle(cache, options) {\n  const {\n    plain = false,\n    types = ['style', 'token', 'cssVar'],\n    once = false\n  } = typeof options === 'boolean' ? {\n    plain: options\n  } : options || {};\n  const matchPrefixRegexp = new RegExp(\"^(\".concat((typeof types === 'string' ? [types] : types).join('|'), \")%\"));\n\n  // prefix with `style` is used for `useStyleRegister` to cache style context\n  const styleKeys = Array.from(cache.cache.keys()).filter(key => matchPrefixRegexp.test(key));\n\n  // Common effect styles like animation\n  const effectStyles = {};\n\n  // Mapping of cachePath to style hash\n  const cachePathMap = {};\n  let styleText = '';\n  styleKeys.map(key => {\n    if (once && cache.extracted.has(key)) {\n      return null; // Skip if already extracted\n    }\n    const cachePath = key.replace(matchPrefixRegexp, '').replace(/%/g, '|');\n    const [prefix] = key.split('%');\n    const extractFn = ExtractStyleFns[prefix];\n    const extractedStyle = extractFn(cache.cache.get(key)[1], effectStyles, {\n      plain\n    });\n    if (!extractedStyle) {\n      return null;\n    }\n    const updateTime = cache.updateTimes.get(key) || 0;\n    const [order, styleId, styleStr] = extractedStyle;\n    if (key.startsWith('style')) {\n      cachePathMap[cachePath] = styleId;\n    }\n\n    // record that this style has been extracted\n    cache.extracted.add(key);\n    return [order, styleStr, updateTime];\n  }).filter(isNotNull).sort((_ref, _ref2) => {\n    let [o1,, u1] = _ref;\n    let [o2,, u2] = _ref2;\n    if (o1 !== o2) {\n      return o1 - o2;\n    }\n    return u1 - u2;\n  }).forEach(_ref3 => {\n    let [, style] = _ref3;\n    styleText += style;\n  });\n\n  // ==================== Fill Cache Path ====================\n  styleText += toStyleStr(\".\".concat(ATTR_CACHE_MAP, \"{content:\\\"\").concat(serializeCacheMap(cachePathMap), \"\\\";}\"), undefined, undefined, {\n    [ATTR_CACHE_MAP]: ATTR_CACHE_MAP\n  }, plain);\n  return styleText;\n}","map":{"version":3,"names":["extract","tokenExtractStyle","TOKEN_PREFIX","CSS_VAR_PREFIX","cssVarExtractStyle","styleExtractStyle","STYLE_PREFIX","toStyleStr","ATTR_CACHE_MAP","serialize","serializeCacheMap","ExtractStyleFns","isNotNull","value","extractStyle","cache","options","plain","types","once","matchPrefixRegexp","RegExp","concat","join","styleKeys","Array","from","keys","filter","key","test","effectStyles","cachePathMap","styleText","map","extracted","has","cachePath","replace","prefix","split","extractFn","extractedStyle","get","updateTime","updateTimes","order","styleId","styleStr","startsWith","add","sort","_ref","_ref2","o1","u1","o2","u2","forEach","_ref3","style","undefined"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@ant-design/cssinjs/es/extractStyle.js"],"sourcesContent":["import { extract as tokenExtractStyle, TOKEN_PREFIX } from \"./hooks/useCacheToken\";\nimport { CSS_VAR_PREFIX, extract as cssVarExtractStyle } from \"./hooks/useCSSVarRegister\";\nimport { extract as styleExtractStyle, STYLE_PREFIX } from \"./hooks/useStyleRegister\";\nimport { toStyleStr } from \"./util\";\nimport { ATTR_CACHE_MAP, serialize as serializeCacheMap } from \"./util/cacheMapUtil\";\nconst ExtractStyleFns = {\n  [STYLE_PREFIX]: styleExtractStyle,\n  [TOKEN_PREFIX]: tokenExtractStyle,\n  [CSS_VAR_PREFIX]: cssVarExtractStyle\n};\nfunction isNotNull(value) {\n  return value !== null;\n}\nexport default function extractStyle(cache, options) {\n  const {\n    plain = false,\n    types = ['style', 'token', 'cssVar'],\n    once = false\n  } = typeof options === 'boolean' ? {\n    plain: options\n  } : options || {};\n  const matchPrefixRegexp = new RegExp(`^(${(typeof types === 'string' ? [types] : types).join('|')})%`);\n\n  // prefix with `style` is used for `useStyleRegister` to cache style context\n  const styleKeys = Array.from(cache.cache.keys()).filter(key => matchPrefixRegexp.test(key));\n\n  // Common effect styles like animation\n  const effectStyles = {};\n\n  // Mapping of cachePath to style hash\n  const cachePathMap = {};\n  let styleText = '';\n  styleKeys.map(key => {\n    if (once && cache.extracted.has(key)) {\n      return null; // Skip if already extracted\n    }\n    const cachePath = key.replace(matchPrefixRegexp, '').replace(/%/g, '|');\n    const [prefix] = key.split('%');\n    const extractFn = ExtractStyleFns[prefix];\n    const extractedStyle = extractFn(cache.cache.get(key)[1], effectStyles, {\n      plain\n    });\n    if (!extractedStyle) {\n      return null;\n    }\n    const updateTime = cache.updateTimes.get(key) || 0;\n    const [order, styleId, styleStr] = extractedStyle;\n    if (key.startsWith('style')) {\n      cachePathMap[cachePath] = styleId;\n    }\n\n    // record that this style has been extracted\n    cache.extracted.add(key);\n    return [order, styleStr, updateTime];\n  }).filter(isNotNull).sort(([o1,, u1], [o2,, u2]) => {\n    if (o1 !== o2) {\n      return o1 - o2;\n    }\n    return u1 - u2;\n  }).forEach(([, style]) => {\n    styleText += style;\n  });\n\n  // ==================== Fill Cache Path ====================\n  styleText += toStyleStr(`.${ATTR_CACHE_MAP}{content:\"${serializeCacheMap(cachePathMap)}\";}`, undefined, undefined, {\n    [ATTR_CACHE_MAP]: ATTR_CACHE_MAP\n  }, plain);\n  return styleText;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}