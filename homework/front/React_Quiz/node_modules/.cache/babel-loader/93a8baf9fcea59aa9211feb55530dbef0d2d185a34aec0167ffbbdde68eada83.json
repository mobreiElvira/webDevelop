{"ast":null,"code":"import { getShadowRoot } from \"@rc-component/util/es/Dom/shadow\";\nimport { warning } from \"@rc-component/util/es/warning\";\nimport * as React from 'react';\nimport { getWin } from \"../util\";\n\n/**\n * Close if click on the window.\n * Return the function that click on the Popup element.\n */\nexport default function useWinClick(open, clickToHide, targetEle, popupEle, mask, maskClosable, inPopupOrChild, triggerOpen) {\n  const openRef = React.useRef(open);\n  openRef.current = open;\n  const popupPointerDownRef = React.useRef(false);\n\n  // Click to hide is special action since click popup element should not hide\n  React.useEffect(() => {\n    if (clickToHide && popupEle && (!mask || maskClosable)) {\n      const onPointerDown = () => {\n        popupPointerDownRef.current = false;\n      };\n      const onTriggerClose = e => {\n        var _e$composedPath;\n        if (openRef.current && !inPopupOrChild(((_e$composedPath = e.composedPath) === null || _e$composedPath === void 0 || (_e$composedPath = _e$composedPath.call(e)) === null || _e$composedPath === void 0 ? void 0 : _e$composedPath[0]) || e.target) && !popupPointerDownRef.current) {\n          triggerOpen(false);\n        }\n      };\n      const win = getWin(popupEle);\n      win.addEventListener('pointerdown', onPointerDown, true);\n      win.addEventListener('mousedown', onTriggerClose, true);\n      win.addEventListener('contextmenu', onTriggerClose, true);\n\n      // shadow root\n      const targetShadowRoot = getShadowRoot(targetEle);\n      if (targetShadowRoot) {\n        targetShadowRoot.addEventListener('mousedown', onTriggerClose, true);\n        targetShadowRoot.addEventListener('contextmenu', onTriggerClose, true);\n      }\n\n      // Warning if target and popup not in same root\n      if (process.env.NODE_ENV !== 'production' && targetEle) {\n        var _targetEle$getRootNod, _popupEle$getRootNode;\n        const targetRoot = (_targetEle$getRootNod = targetEle.getRootNode) === null || _targetEle$getRootNod === void 0 ? void 0 : _targetEle$getRootNod.call(targetEle);\n        const popupRoot = (_popupEle$getRootNode = popupEle.getRootNode) === null || _popupEle$getRootNode === void 0 ? void 0 : _popupEle$getRootNode.call(popupEle);\n        warning(targetRoot === popupRoot, \"trigger element and popup element should in same shadow root.\");\n      }\n      return () => {\n        win.removeEventListener('pointerdown', onPointerDown, true);\n        win.removeEventListener('mousedown', onTriggerClose, true);\n        win.removeEventListener('contextmenu', onTriggerClose, true);\n        if (targetShadowRoot) {\n          targetShadowRoot.removeEventListener('mousedown', onTriggerClose, true);\n          targetShadowRoot.removeEventListener('contextmenu', onTriggerClose, true);\n        }\n      };\n    }\n  }, [clickToHide, targetEle, popupEle, mask, maskClosable]);\n  function onPopupPointerDown() {\n    popupPointerDownRef.current = true;\n  }\n  return onPopupPointerDown;\n}","map":{"version":3,"names":["getShadowRoot","warning","React","getWin","useWinClick","open","clickToHide","targetEle","popupEle","mask","maskClosable","inPopupOrChild","triggerOpen","openRef","useRef","current","popupPointerDownRef","useEffect","onPointerDown","onTriggerClose","e","_e$composedPath","composedPath","call","target","win","addEventListener","targetShadowRoot","process","env","NODE_ENV","_targetEle$getRootNod","_popupEle$getRootNode","targetRoot","getRootNode","popupRoot","removeEventListener","onPopupPointerDown"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/trigger/es/hooks/useWinClick.js"],"sourcesContent":["import { getShadowRoot } from \"@rc-component/util/es/Dom/shadow\";\nimport { warning } from \"@rc-component/util/es/warning\";\nimport * as React from 'react';\nimport { getWin } from \"../util\";\n\n/**\n * Close if click on the window.\n * Return the function that click on the Popup element.\n */\nexport default function useWinClick(open, clickToHide, targetEle, popupEle, mask, maskClosable, inPopupOrChild, triggerOpen) {\n  const openRef = React.useRef(open);\n  openRef.current = open;\n  const popupPointerDownRef = React.useRef(false);\n\n  // Click to hide is special action since click popup element should not hide\n  React.useEffect(() => {\n    if (clickToHide && popupEle && (!mask || maskClosable)) {\n      const onPointerDown = () => {\n        popupPointerDownRef.current = false;\n      };\n      const onTriggerClose = e => {\n        if (openRef.current && !inPopupOrChild(e.composedPath?.()?.[0] || e.target) && !popupPointerDownRef.current) {\n          triggerOpen(false);\n        }\n      };\n      const win = getWin(popupEle);\n      win.addEventListener('pointerdown', onPointerDown, true);\n      win.addEventListener('mousedown', onTriggerClose, true);\n      win.addEventListener('contextmenu', onTriggerClose, true);\n\n      // shadow root\n      const targetShadowRoot = getShadowRoot(targetEle);\n      if (targetShadowRoot) {\n        targetShadowRoot.addEventListener('mousedown', onTriggerClose, true);\n        targetShadowRoot.addEventListener('contextmenu', onTriggerClose, true);\n      }\n\n      // Warning if target and popup not in same root\n      if (process.env.NODE_ENV !== 'production' && targetEle) {\n        const targetRoot = targetEle.getRootNode?.();\n        const popupRoot = popupEle.getRootNode?.();\n        warning(targetRoot === popupRoot, `trigger element and popup element should in same shadow root.`);\n      }\n      return () => {\n        win.removeEventListener('pointerdown', onPointerDown, true);\n        win.removeEventListener('mousedown', onTriggerClose, true);\n        win.removeEventListener('contextmenu', onTriggerClose, true);\n        if (targetShadowRoot) {\n          targetShadowRoot.removeEventListener('mousedown', onTriggerClose, true);\n          targetShadowRoot.removeEventListener('contextmenu', onTriggerClose, true);\n        }\n      };\n    }\n  }, [clickToHide, targetEle, popupEle, mask, maskClosable]);\n  function onPopupPointerDown() {\n    popupPointerDownRef.current = true;\n  }\n  return onPopupPointerDown;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}