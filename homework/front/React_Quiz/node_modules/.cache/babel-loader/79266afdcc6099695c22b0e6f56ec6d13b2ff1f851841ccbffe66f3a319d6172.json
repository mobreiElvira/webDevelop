{"ast":null,"code":"import * as React from 'react';\nimport { useRef, useState } from 'react';\nconst MIN_SWIPE_DISTANCE = 0.1;\nconst STOP_SWIPE_DISTANCE = 0.01;\nconst REFRESH_INTERVAL = 20;\nconst SPEED_OFF_MULTIPLE = 0.995 ** REFRESH_INTERVAL;\n\n// ================================= Hook =================================\nexport default function useTouchMove(ref, onOffset) {\n  const [touchPosition, setTouchPosition] = useState();\n  const [lastTimestamp, setLastTimestamp] = useState(0);\n  const [lastTimeDiff, setLastTimeDiff] = useState(0);\n  const [lastOffset, setLastOffset] = useState();\n  const motionRef = useRef();\n\n  // ========================= Events =========================\n  // >>> Touch events\n  function onTouchStart(e) {\n    const {\n      screenX,\n      screenY\n    } = e.touches[0];\n    setTouchPosition({\n      x: screenX,\n      y: screenY\n    });\n    window.clearInterval(motionRef.current);\n  }\n  function onTouchMove(e) {\n    if (!touchPosition) return;\n\n    // e.preventDefault();\n    const {\n      screenX,\n      screenY\n    } = e.touches[0];\n    setTouchPosition({\n      x: screenX,\n      y: screenY\n    });\n    const offsetX = screenX - touchPosition.x;\n    const offsetY = screenY - touchPosition.y;\n    onOffset(offsetX, offsetY);\n    const now = Date.now();\n    setLastTimestamp(now);\n    setLastTimeDiff(now - lastTimestamp);\n    setLastOffset({\n      x: offsetX,\n      y: offsetY\n    });\n  }\n  function onTouchEnd() {\n    if (!touchPosition) return;\n    setTouchPosition(null);\n    setLastOffset(null);\n\n    // Swipe if needed\n    if (lastOffset) {\n      const distanceX = lastOffset.x / lastTimeDiff;\n      const distanceY = lastOffset.y / lastTimeDiff;\n      const absX = Math.abs(distanceX);\n      const absY = Math.abs(distanceY);\n\n      // Skip swipe if low distance\n      if (Math.max(absX, absY) < MIN_SWIPE_DISTANCE) return;\n      let currentX = distanceX;\n      let currentY = distanceY;\n      motionRef.current = window.setInterval(() => {\n        if (Math.abs(currentX) < STOP_SWIPE_DISTANCE && Math.abs(currentY) < STOP_SWIPE_DISTANCE) {\n          window.clearInterval(motionRef.current);\n          return;\n        }\n        currentX *= SPEED_OFF_MULTIPLE;\n        currentY *= SPEED_OFF_MULTIPLE;\n        onOffset(currentX * REFRESH_INTERVAL, currentY * REFRESH_INTERVAL);\n      }, REFRESH_INTERVAL);\n    }\n  }\n\n  // >>> Wheel event\n  const lastWheelDirectionRef = useRef();\n  function onWheel(e) {\n    const {\n      deltaX,\n      deltaY\n    } = e;\n\n    // Convert both to x & y since wheel only happened on PC\n    let mixed = 0;\n    const absX = Math.abs(deltaX);\n    const absY = Math.abs(deltaY);\n    if (absX === absY) {\n      mixed = lastWheelDirectionRef.current === 'x' ? deltaX : deltaY;\n    } else if (absX > absY) {\n      mixed = deltaX;\n      lastWheelDirectionRef.current = 'x';\n    } else {\n      mixed = deltaY;\n      lastWheelDirectionRef.current = 'y';\n    }\n    if (onOffset(-mixed, -mixed)) {\n      e.preventDefault();\n    }\n  }\n\n  // ========================= Effect =========================\n  const touchEventsRef = useRef(null);\n  touchEventsRef.current = {\n    onTouchStart,\n    onTouchMove,\n    onTouchEnd,\n    onWheel\n  };\n  React.useEffect(() => {\n    function onProxyTouchStart(e) {\n      touchEventsRef.current.onTouchStart(e);\n    }\n    function onProxyTouchMove(e) {\n      touchEventsRef.current.onTouchMove(e);\n    }\n    function onProxyTouchEnd(e) {\n      touchEventsRef.current.onTouchEnd(e);\n    }\n    function onProxyWheel(e) {\n      touchEventsRef.current.onWheel(e);\n    }\n    document.addEventListener('touchmove', onProxyTouchMove, {\n      passive: false\n    });\n    document.addEventListener('touchend', onProxyTouchEnd, {\n      passive: true\n    });\n\n    // No need to clean up since element removed\n    ref.current.addEventListener('touchstart', onProxyTouchStart, {\n      passive: true\n    });\n    ref.current.addEventListener('wheel', onProxyWheel, {\n      passive: false\n    });\n    return () => {\n      document.removeEventListener('touchmove', onProxyTouchMove);\n      document.removeEventListener('touchend', onProxyTouchEnd);\n    };\n  }, []);\n}","map":{"version":3,"names":["React","useRef","useState","MIN_SWIPE_DISTANCE","STOP_SWIPE_DISTANCE","REFRESH_INTERVAL","SPEED_OFF_MULTIPLE","useTouchMove","ref","onOffset","touchPosition","setTouchPosition","lastTimestamp","setLastTimestamp","lastTimeDiff","setLastTimeDiff","lastOffset","setLastOffset","motionRef","onTouchStart","e","screenX","screenY","touches","x","y","window","clearInterval","current","onTouchMove","offsetX","offsetY","now","Date","onTouchEnd","distanceX","distanceY","absX","Math","abs","absY","max","currentX","currentY","setInterval","lastWheelDirectionRef","onWheel","deltaX","deltaY","mixed","preventDefault","touchEventsRef","useEffect","onProxyTouchStart","onProxyTouchMove","onProxyTouchEnd","onProxyWheel","document","addEventListener","passive","removeEventListener"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/tabs/es/hooks/useTouchMove.js"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useState } from 'react';\nconst MIN_SWIPE_DISTANCE = 0.1;\nconst STOP_SWIPE_DISTANCE = 0.01;\nconst REFRESH_INTERVAL = 20;\nconst SPEED_OFF_MULTIPLE = 0.995 ** REFRESH_INTERVAL;\n\n// ================================= Hook =================================\nexport default function useTouchMove(ref, onOffset) {\n  const [touchPosition, setTouchPosition] = useState();\n  const [lastTimestamp, setLastTimestamp] = useState(0);\n  const [lastTimeDiff, setLastTimeDiff] = useState(0);\n  const [lastOffset, setLastOffset] = useState();\n  const motionRef = useRef();\n\n  // ========================= Events =========================\n  // >>> Touch events\n  function onTouchStart(e) {\n    const {\n      screenX,\n      screenY\n    } = e.touches[0];\n    setTouchPosition({\n      x: screenX,\n      y: screenY\n    });\n    window.clearInterval(motionRef.current);\n  }\n  function onTouchMove(e) {\n    if (!touchPosition) return;\n\n    // e.preventDefault();\n    const {\n      screenX,\n      screenY\n    } = e.touches[0];\n    setTouchPosition({\n      x: screenX,\n      y: screenY\n    });\n    const offsetX = screenX - touchPosition.x;\n    const offsetY = screenY - touchPosition.y;\n    onOffset(offsetX, offsetY);\n    const now = Date.now();\n    setLastTimestamp(now);\n    setLastTimeDiff(now - lastTimestamp);\n    setLastOffset({\n      x: offsetX,\n      y: offsetY\n    });\n  }\n  function onTouchEnd() {\n    if (!touchPosition) return;\n    setTouchPosition(null);\n    setLastOffset(null);\n\n    // Swipe if needed\n    if (lastOffset) {\n      const distanceX = lastOffset.x / lastTimeDiff;\n      const distanceY = lastOffset.y / lastTimeDiff;\n      const absX = Math.abs(distanceX);\n      const absY = Math.abs(distanceY);\n\n      // Skip swipe if low distance\n      if (Math.max(absX, absY) < MIN_SWIPE_DISTANCE) return;\n      let currentX = distanceX;\n      let currentY = distanceY;\n      motionRef.current = window.setInterval(() => {\n        if (Math.abs(currentX) < STOP_SWIPE_DISTANCE && Math.abs(currentY) < STOP_SWIPE_DISTANCE) {\n          window.clearInterval(motionRef.current);\n          return;\n        }\n        currentX *= SPEED_OFF_MULTIPLE;\n        currentY *= SPEED_OFF_MULTIPLE;\n        onOffset(currentX * REFRESH_INTERVAL, currentY * REFRESH_INTERVAL);\n      }, REFRESH_INTERVAL);\n    }\n  }\n\n  // >>> Wheel event\n  const lastWheelDirectionRef = useRef();\n  function onWheel(e) {\n    const {\n      deltaX,\n      deltaY\n    } = e;\n\n    // Convert both to x & y since wheel only happened on PC\n    let mixed = 0;\n    const absX = Math.abs(deltaX);\n    const absY = Math.abs(deltaY);\n    if (absX === absY) {\n      mixed = lastWheelDirectionRef.current === 'x' ? deltaX : deltaY;\n    } else if (absX > absY) {\n      mixed = deltaX;\n      lastWheelDirectionRef.current = 'x';\n    } else {\n      mixed = deltaY;\n      lastWheelDirectionRef.current = 'y';\n    }\n    if (onOffset(-mixed, -mixed)) {\n      e.preventDefault();\n    }\n  }\n\n  // ========================= Effect =========================\n  const touchEventsRef = useRef(null);\n  touchEventsRef.current = {\n    onTouchStart,\n    onTouchMove,\n    onTouchEnd,\n    onWheel\n  };\n  React.useEffect(() => {\n    function onProxyTouchStart(e) {\n      touchEventsRef.current.onTouchStart(e);\n    }\n    function onProxyTouchMove(e) {\n      touchEventsRef.current.onTouchMove(e);\n    }\n    function onProxyTouchEnd(e) {\n      touchEventsRef.current.onTouchEnd(e);\n    }\n    function onProxyWheel(e) {\n      touchEventsRef.current.onWheel(e);\n    }\n    document.addEventListener('touchmove', onProxyTouchMove, {\n      passive: false\n    });\n    document.addEventListener('touchend', onProxyTouchEnd, {\n      passive: true\n    });\n\n    // No need to clean up since element removed\n    ref.current.addEventListener('touchstart', onProxyTouchStart, {\n      passive: true\n    });\n    ref.current.addEventListener('wheel', onProxyWheel, {\n      passive: false\n    });\n    return () => {\n      document.removeEventListener('touchmove', onProxyTouchMove);\n      document.removeEventListener('touchend', onProxyTouchEnd);\n    };\n  }, []);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}