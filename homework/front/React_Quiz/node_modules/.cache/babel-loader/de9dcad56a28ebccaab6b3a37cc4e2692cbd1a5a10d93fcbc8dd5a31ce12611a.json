{"ast":null,"code":"import { useEffect, useRef, useState } from 'react';\nimport { isImageValid } from \"../util\";\nexport default function useStatus(_ref) {\n  let {\n    src,\n    isCustomPlaceholder,\n    fallback\n  } = _ref;\n  const [status, setStatus] = useState(isCustomPlaceholder ? 'loading' : 'normal');\n  const isLoaded = useRef(false);\n  const isError = status === 'error';\n\n  // https://github.com/react-component/image/pull/187\n  useEffect(() => {\n    let isCurrentSrc = true;\n    isImageValid(src).then(isValid => {\n      // https://github.com/ant-design/ant-design/issues/44948\n      // If src changes, the previous setStatus should not be triggered\n      if (!isValid && isCurrentSrc) {\n        setStatus('error');\n      }\n    });\n    return () => {\n      isCurrentSrc = false;\n    };\n  }, [src]);\n  useEffect(() => {\n    if (isCustomPlaceholder && !isLoaded.current) {\n      setStatus('loading');\n    } else if (isError) {\n      setStatus('normal');\n    }\n  }, [src]);\n  const onLoad = () => {\n    setStatus('normal');\n  };\n  const getImgRef = img => {\n    isLoaded.current = false;\n    if (status === 'loading' && img !== null && img !== void 0 && img.complete && (img.naturalWidth || img.naturalHeight)) {\n      isLoaded.current = true;\n      onLoad();\n    }\n  };\n  const srcAndOnload = isError && fallback ? {\n    src: fallback\n  } : {\n    onLoad,\n    src\n  };\n  return [getImgRef, srcAndOnload, status];\n}","map":{"version":3,"names":["useEffect","useRef","useState","isImageValid","useStatus","_ref","src","isCustomPlaceholder","fallback","status","setStatus","isLoaded","isError","isCurrentSrc","then","isValid","current","onLoad","getImgRef","img","complete","naturalWidth","naturalHeight","srcAndOnload"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/image/es/hooks/useStatus.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { isImageValid } from \"../util\";\nexport default function useStatus({\n  src,\n  isCustomPlaceholder,\n  fallback\n}) {\n  const [status, setStatus] = useState(isCustomPlaceholder ? 'loading' : 'normal');\n  const isLoaded = useRef(false);\n  const isError = status === 'error';\n\n  // https://github.com/react-component/image/pull/187\n  useEffect(() => {\n    let isCurrentSrc = true;\n    isImageValid(src).then(isValid => {\n      // https://github.com/ant-design/ant-design/issues/44948\n      // If src changes, the previous setStatus should not be triggered\n      if (!isValid && isCurrentSrc) {\n        setStatus('error');\n      }\n    });\n    return () => {\n      isCurrentSrc = false;\n    };\n  }, [src]);\n  useEffect(() => {\n    if (isCustomPlaceholder && !isLoaded.current) {\n      setStatus('loading');\n    } else if (isError) {\n      setStatus('normal');\n    }\n  }, [src]);\n  const onLoad = () => {\n    setStatus('normal');\n  };\n  const getImgRef = img => {\n    isLoaded.current = false;\n    if (status === 'loading' && img?.complete && (img.naturalWidth || img.naturalHeight)) {\n      isLoaded.current = true;\n      onLoad();\n    }\n  };\n  const srcAndOnload = isError && fallback ? {\n    src: fallback\n  } : {\n    onLoad,\n    src\n  };\n  return [getImgRef, srcAndOnload, status];\n}"],"mappings":"AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACnD,SAASC,YAAY,QAAQ,SAAS;AACtC,eAAe,SAASC,SAASA,CAAAC,IAAA,EAI9B;EAAA,IAJ+B;IAChCC,GAAG;IACHC,mBAAmB;IACnBC;EACF,CAAC,GAAAH,IAAA;EACC,MAAM,CAACI,MAAM,EAAEC,SAAS,CAAC,GAAGR,QAAQ,CAACK,mBAAmB,GAAG,SAAS,GAAG,QAAQ,CAAC;EAChF,MAAMI,QAAQ,GAAGV,MAAM,CAAC,KAAK,CAAC;EAC9B,MAAMW,OAAO,GAAGH,MAAM,KAAK,OAAO;;EAElC;EACAT,SAAS,CAAC,MAAM;IACd,IAAIa,YAAY,GAAG,IAAI;IACvBV,YAAY,CAACG,GAAG,CAAC,CAACQ,IAAI,CAACC,OAAO,IAAI;MAChC;MACA;MACA,IAAI,CAACA,OAAO,IAAIF,YAAY,EAAE;QAC5BH,SAAS,CAAC,OAAO,CAAC;MACpB;IACF,CAAC,CAAC;IACF,OAAO,MAAM;MACXG,YAAY,GAAG,KAAK;IACtB,CAAC;EACH,CAAC,EAAE,CAACP,GAAG,CAAC,CAAC;EACTN,SAAS,CAAC,MAAM;IACd,IAAIO,mBAAmB,IAAI,CAACI,QAAQ,CAACK,OAAO,EAAE;MAC5CN,SAAS,CAAC,SAAS,CAAC;IACtB,CAAC,MAAM,IAAIE,OAAO,EAAE;MAClBF,SAAS,CAAC,QAAQ,CAAC;IACrB;EACF,CAAC,EAAE,CAACJ,GAAG,CAAC,CAAC;EACT,MAAMW,MAAM,GAAGA,CAAA,KAAM;IACnBP,SAAS,CAAC,QAAQ,CAAC;EACrB,CAAC;EACD,MAAMQ,SAAS,GAAGC,GAAG,IAAI;IACvBR,QAAQ,CAACK,OAAO,GAAG,KAAK;IACxB,IAAIP,MAAM,KAAK,SAAS,IAAIU,GAAG,aAAHA,GAAG,eAAHA,GAAG,CAAEC,QAAQ,KAAKD,GAAG,CAACE,YAAY,IAAIF,GAAG,CAACG,aAAa,CAAC,EAAE;MACpFX,QAAQ,CAACK,OAAO,GAAG,IAAI;MACvBC,MAAM,CAAC,CAAC;IACV;EACF,CAAC;EACD,MAAMM,YAAY,GAAGX,OAAO,IAAIJ,QAAQ,GAAG;IACzCF,GAAG,EAAEE;EACP,CAAC,GAAG;IACFS,MAAM;IACNX;EACF,CAAC;EACD,OAAO,CAACY,SAAS,EAAEK,YAAY,EAAEd,MAAM,CAAC;AAC1C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}