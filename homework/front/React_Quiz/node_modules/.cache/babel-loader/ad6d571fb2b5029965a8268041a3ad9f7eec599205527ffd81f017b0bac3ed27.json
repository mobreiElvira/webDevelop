{"ast":null,"code":"import useEvent from \"@rc-component/util/es/hooks/useEvent\";\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport { useMemo, useState } from 'react';\nimport { isInViewPort } from \"../util\";\nfunction isValidNumber(val) {\n  return typeof val === 'number' && !Number.isNaN(val);\n}\nexport default function useTarget(target, open, gap, scrollIntoViewOptions, inlineMode, placeholderRef) {\n  // ========================= Target =========================\n  // We trade `undefined` as not get target by function yet.\n  // `null` as empty target.\n  const [targetElement, setTargetElement] = useState(undefined);\n  useLayoutEffect(() => {\n    const nextElement = typeof target === 'function' ? target() : target;\n    setTargetElement(nextElement || null);\n  });\n\n  // ========================= Align ==========================\n  const [posInfo, setPosInfo] = useState(null);\n  const updatePos = useEvent(() => {\n    if (targetElement) {\n      // Exist target element. We should scroll and get target position\n      if (!inlineMode && !isInViewPort(targetElement) && open) {\n        targetElement.scrollIntoView(scrollIntoViewOptions);\n      }\n      const {\n        left,\n        top,\n        width,\n        height\n      } = targetElement.getBoundingClientRect();\n      const nextPosInfo = {\n        left,\n        top,\n        width,\n        height,\n        radius: 0\n      };\n\n      // If `inlineMode` we need cut off parent offset\n      if (inlineMode) {\n        var _placeholderRef$curre;\n        const parentRect = (_placeholderRef$curre = placeholderRef.current) === null || _placeholderRef$curre === void 0 || (_placeholderRef$curre = _placeholderRef$curre.parentElement) === null || _placeholderRef$curre === void 0 ? void 0 : _placeholderRef$curre.getBoundingClientRect();\n        if (parentRect) {\n          nextPosInfo.left -= parentRect.left;\n          nextPosInfo.top -= parentRect.top;\n        }\n      }\n      setPosInfo(origin => {\n        if (JSON.stringify(origin) !== JSON.stringify(nextPosInfo)) {\n          return nextPosInfo;\n        }\n        return origin;\n      });\n    } else {\n      // Not exist target which means we just show in center\n      setPosInfo(null);\n    }\n  });\n  const getGapOffset = index => {\n    var _ref;\n    return (_ref = Array.isArray(gap === null || gap === void 0 ? void 0 : gap.offset) ? gap === null || gap === void 0 ? void 0 : gap.offset[index] : gap === null || gap === void 0 ? void 0 : gap.offset) !== null && _ref !== void 0 ? _ref : 6;\n  };\n  useLayoutEffect(() => {\n    updatePos();\n    // update when window resize\n    window.addEventListener('resize', updatePos);\n    // update when `document.body.style.overflow` is set to visible\n    // by default, it will be set to hidden\n    window.addEventListener('scroll', updatePos);\n    return () => {\n      window.removeEventListener('resize', updatePos);\n      window.removeEventListener('scroll', updatePos);\n    };\n  }, [targetElement, open, updatePos]);\n\n  // ======================== PosInfo =========================\n  const mergedPosInfo = useMemo(() => {\n    if (!posInfo) {\n      return posInfo;\n    }\n    const gapOffsetX = getGapOffset(0);\n    const gapOffsetY = getGapOffset(1);\n    const gapRadius = isValidNumber(gap === null || gap === void 0 ? void 0 : gap.radius) ? gap === null || gap === void 0 ? void 0 : gap.radius : 2;\n    return {\n      left: posInfo.left - gapOffsetX,\n      top: posInfo.top - gapOffsetY,\n      width: posInfo.width + gapOffsetX * 2,\n      height: posInfo.height + gapOffsetY * 2,\n      radius: gapRadius\n    };\n  }, [posInfo, gap]);\n  return [mergedPosInfo, targetElement];\n}","map":{"version":3,"names":["useEvent","useLayoutEffect","useMemo","useState","isInViewPort","isValidNumber","val","Number","isNaN","useTarget","target","open","gap","scrollIntoViewOptions","inlineMode","placeholderRef","targetElement","setTargetElement","undefined","nextElement","posInfo","setPosInfo","updatePos","scrollIntoView","left","top","width","height","getBoundingClientRect","nextPosInfo","radius","_placeholderRef$curre","parentRect","current","parentElement","origin","JSON","stringify","getGapOffset","index","_ref","Array","isArray","offset","window","addEventListener","removeEventListener","mergedPosInfo","gapOffsetX","gapOffsetY","gapRadius"],"sources":["F:/综合/个人/作业/主课/大三/web开发/homework/front/React_Quiz/node_modules/@rc-component/tour/es/hooks/useTarget.js"],"sourcesContent":["import useEvent from \"@rc-component/util/es/hooks/useEvent\";\nimport useLayoutEffect from \"@rc-component/util/es/hooks/useLayoutEffect\";\nimport { useMemo, useState } from 'react';\nimport { isInViewPort } from \"../util\";\nfunction isValidNumber(val) {\n  return typeof val === 'number' && !Number.isNaN(val);\n}\nexport default function useTarget(target, open, gap, scrollIntoViewOptions, inlineMode, placeholderRef) {\n  // ========================= Target =========================\n  // We trade `undefined` as not get target by function yet.\n  // `null` as empty target.\n  const [targetElement, setTargetElement] = useState(undefined);\n  useLayoutEffect(() => {\n    const nextElement = typeof target === 'function' ? target() : target;\n    setTargetElement(nextElement || null);\n  });\n\n  // ========================= Align ==========================\n  const [posInfo, setPosInfo] = useState(null);\n  const updatePos = useEvent(() => {\n    if (targetElement) {\n      // Exist target element. We should scroll and get target position\n      if (!inlineMode && !isInViewPort(targetElement) && open) {\n        targetElement.scrollIntoView(scrollIntoViewOptions);\n      }\n      const {\n        left,\n        top,\n        width,\n        height\n      } = targetElement.getBoundingClientRect();\n      const nextPosInfo = {\n        left,\n        top,\n        width,\n        height,\n        radius: 0\n      };\n\n      // If `inlineMode` we need cut off parent offset\n      if (inlineMode) {\n        const parentRect = placeholderRef.current?.parentElement?.getBoundingClientRect();\n        if (parentRect) {\n          nextPosInfo.left -= parentRect.left;\n          nextPosInfo.top -= parentRect.top;\n        }\n      }\n      setPosInfo(origin => {\n        if (JSON.stringify(origin) !== JSON.stringify(nextPosInfo)) {\n          return nextPosInfo;\n        }\n        return origin;\n      });\n    } else {\n      // Not exist target which means we just show in center\n      setPosInfo(null);\n    }\n  });\n  const getGapOffset = index => (Array.isArray(gap?.offset) ? gap?.offset[index] : gap?.offset) ?? 6;\n  useLayoutEffect(() => {\n    updatePos();\n    // update when window resize\n    window.addEventListener('resize', updatePos);\n    // update when `document.body.style.overflow` is set to visible\n    // by default, it will be set to hidden\n    window.addEventListener('scroll', updatePos);\n    return () => {\n      window.removeEventListener('resize', updatePos);\n      window.removeEventListener('scroll', updatePos);\n    };\n  }, [targetElement, open, updatePos]);\n\n  // ======================== PosInfo =========================\n  const mergedPosInfo = useMemo(() => {\n    if (!posInfo) {\n      return posInfo;\n    }\n    const gapOffsetX = getGapOffset(0);\n    const gapOffsetY = getGapOffset(1);\n    const gapRadius = isValidNumber(gap?.radius) ? gap?.radius : 2;\n    return {\n      left: posInfo.left - gapOffsetX,\n      top: posInfo.top - gapOffsetY,\n      width: posInfo.width + gapOffsetX * 2,\n      height: posInfo.height + gapOffsetY * 2,\n      radius: gapRadius\n    };\n  }, [posInfo, gap]);\n  return [mergedPosInfo, targetElement];\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}